Version 4
SHEET 1 10284 4212
WIRE 1280 -848 1280 -912
WIRE 1440 -848 1440 -912
WIRE 1856 -848 1856 -912
WIRE 1280 -752 1280 -768
WIRE 1440 -752 1440 -768
WIRE 1856 -752 1856 -768
WIRE 1040 32 544 32
WIRE 1536 32 1040 32
WIRE 1936 32 1936 -64
WIRE 1936 32 1536 32
WIRE 2064 32 1936 32
WIRE 768 96 272 96
WIRE 1264 96 768 96
WIRE 1648 96 1648 -64
WIRE 1648 96 1264 96
WIRE 1792 96 1648 96
WIRE 288 176 288 -128
WIRE 560 176 560 -128
WIRE 784 176 784 -128
WIRE 1056 176 1056 -128
WIRE 1280 176 1280 -128
WIRE 1552 176 1552 -128
WIRE 1808 176 1808 -128
WIRE 2080 176 2080 -128
WIRE 272 224 272 96
WIRE 544 224 544 32
WIRE 768 224 768 96
WIRE 1040 224 1040 32
WIRE 1264 224 1264 96
WIRE 1536 224 1536 32
WIRE 1792 224 1792 96
WIRE 2064 224 2064 32
WIRE 368 480 368 224
WIRE 448 480 368 480
WIRE 544 480 512 480
WIRE 864 480 864 224
WIRE 944 480 864 480
WIRE 1040 480 1008 480
WIRE 1360 480 1360 224
WIRE 1440 480 1360 480
WIRE 1536 480 1504 480
WIRE 1888 480 1888 224
WIRE 1968 480 1888 480
WIRE 2064 480 2032 480
WIRE 544 496 544 480
WIRE 640 496 640 224
WIRE 640 496 544 496
WIRE 1040 496 1040 480
WIRE 1136 496 1136 224
WIRE 1136 496 1040 496
WIRE 1536 496 1536 480
WIRE 1632 496 1632 224
WIRE 1632 496 1536 496
WIRE 2064 496 2064 480
WIRE 2160 496 2160 224
WIRE 2160 496 2064 496
WIRE 368 512 368 480
WIRE 368 512 288 512
WIRE 864 512 864 480
WIRE 864 512 784 512
WIRE 1360 512 1360 480
WIRE 1360 512 1280 512
WIRE 1888 512 1888 480
WIRE 1888 512 1808 512
WIRE 368 592 368 512
WIRE 448 592 368 592
WIRE 528 592 512 592
WIRE 544 592 544 496
WIRE 544 592 528 592
WIRE 864 592 864 512
WIRE 944 592 864 592
WIRE 1024 592 1008 592
WIRE 1040 592 1040 496
WIRE 1040 592 1024 592
WIRE 1360 592 1360 512
WIRE 1440 592 1360 592
WIRE 1520 592 1504 592
WIRE 1536 592 1536 496
WIRE 1536 592 1520 592
WIRE 1888 592 1888 512
WIRE 1968 592 1888 592
WIRE 2048 592 2032 592
WIRE 2064 592 2064 496
WIRE 2064 592 2048 592
WIRE 304 736 304 672
WIRE 544 736 544 672
WIRE 800 736 800 672
WIRE 1040 736 1040 672
WIRE 1296 736 1296 672
WIRE 1536 736 1536 672
WIRE 1824 736 1824 672
WIRE 2064 736 2064 672
WIRE 288 784 288 512
WIRE 528 784 528 592
WIRE 784 784 784 512
WIRE 1024 784 1024 592
WIRE 1280 784 1280 512
WIRE 1520 784 1520 592
WIRE 1808 784 1808 512
WIRE 2048 784 2048 592
WIRE 384 896 384 784
WIRE 448 896 384 896
WIRE 624 896 624 784
WIRE 624 896 512 896
WIRE 880 896 880 784
WIRE 944 896 880 896
WIRE 1120 896 1120 784
WIRE 1120 896 1008 896
WIRE 1376 896 1376 784
WIRE 1440 896 1376 896
WIRE 1616 896 1616 784
WIRE 1616 896 1504 896
WIRE 1904 896 1904 784
WIRE 1968 896 1904 896
WIRE 2144 896 2144 784
WIRE 2144 896 2032 896
WIRE 384 1040 384 896
WIRE 448 1040 384 1040
WIRE 624 1040 624 896
WIRE 624 1040 512 1040
WIRE 880 1040 880 896
WIRE 944 1040 880 1040
WIRE 1120 1040 1120 896
WIRE 1120 1040 1008 1040
WIRE 1376 1040 1376 896
WIRE 1440 1040 1376 1040
WIRE 1616 1040 1616 896
WIRE 1616 1040 1504 1040
WIRE 1904 1040 1904 896
WIRE 1968 1040 1904 1040
WIRE 2144 1040 2144 896
WIRE 2144 1040 2032 1040
WIRE 624 1168 624 1040
WIRE 880 1168 880 1040
WIRE 880 1168 624 1168
WIRE 1616 1200 1616 1040
WIRE 1616 1200 1424 1200
WIRE 1904 1200 1904 1040
WIRE 1904 1200 1616 1200
WIRE 2144 1216 2144 1040
WIRE 2144 1216 1536 1216
WIRE 880 1280 880 1168
WIRE 1072 1280 880 1280
WIRE 1120 1280 1120 1040
WIRE 1216 1280 1120 1280
WIRE 1376 1280 1376 1040
WIRE 1376 1280 1248 1280
WIRE 384 1376 384 1040
WIRE 864 1376 384 1376
WIRE 1072 1376 1072 1280
WIRE 1072 1376 1008 1376
WIRE 1216 1376 1216 1280
WIRE 1216 1376 1184 1376
WIRE 1248 1376 1248 1280
WIRE 1248 1376 1216 1376
WIRE 1424 1376 1424 1200
WIRE 1424 1376 1344 1376
WIRE 1536 1376 1536 1216
WIRE 1536 1376 1520 1376
WIRE 1584 1376 1536 1376
WIRE 864 1472 864 1376
WIRE 928 1472 864 1472
WIRE 1072 1472 1072 1376
WIRE 1104 1472 1072 1472
WIRE 1216 1472 1216 1376
WIRE 1248 1472 1248 1376
WIRE 1280 1472 1248 1472
WIRE 1424 1472 1424 1376
WIRE 1456 1472 1424 1472
WIRE 1536 1472 1536 1376
WIRE -384 2080 -592 2080
WIRE -272 2080 -384 2080
WIRE -176 2080 -272 2080
WIRE 1616 2080 1568 2080
WIRE 1808 2080 1696 2080
WIRE 1568 2192 1568 2080
WIRE 1568 2192 96 2192
WIRE 1808 2224 1808 2080
WIRE -384 2256 -384 2080
WIRE -176 2256 -176 2080
WIRE -592 2272 -592 2080
WIRE 96 2272 96 2192
WIRE -592 2432 -592 2336
WIRE -384 2432 -384 2336
WIRE -384 2432 -592 2432
WIRE -176 2432 -176 2336
WIRE -176 2432 -384 2432
WIRE 96 2432 96 2352
WIRE 96 2432 -176 2432
WIRE 1808 2432 1808 2288
WIRE 1808 2432 96 2432
WIRE -592 2464 -592 2432
WIRE -384 2704 -592 2704
WIRE -272 2704 -384 2704
WIRE -176 2704 -272 2704
WIRE 1600 2704 1568 2704
WIRE 1808 2704 1680 2704
WIRE 1568 2816 1568 2704
WIRE 1568 2816 96 2816
WIRE 1808 2848 1808 2704
WIRE -384 2880 -384 2704
WIRE -176 2880 -176 2704
WIRE -592 2896 -592 2704
WIRE 96 2896 96 2816
WIRE -592 3056 -592 2960
WIRE -384 3056 -384 2960
WIRE -384 3056 -592 3056
WIRE -176 3056 -176 2960
WIRE -176 3056 -384 3056
WIRE 96 3056 96 2976
WIRE 96 3056 -176 3056
WIRE 1808 3056 1808 2912
WIRE 1808 3056 96 3056
WIRE -592 3088 -592 3056
WIRE -384 3264 -592 3264
WIRE -272 3264 -384 3264
WIRE -176 3264 -272 3264
WIRE 1600 3264 1568 3264
WIRE 1808 3264 1680 3264
WIRE 1568 3376 1568 3264
WIRE 1568 3376 96 3376
WIRE 1808 3408 1808 3264
WIRE -384 3440 -384 3264
WIRE -176 3440 -176 3264
WIRE -592 3456 -592 3264
WIRE 96 3456 96 3376
WIRE -592 3616 -592 3520
WIRE -384 3616 -384 3520
WIRE -384 3616 -592 3616
WIRE -176 3616 -176 3520
WIRE -176 3616 -384 3616
WIRE 96 3616 96 3536
WIRE 96 3616 -176 3616
WIRE 1808 3616 1808 3472
WIRE 1808 3616 96 3616
WIRE -592 3648 -592 3616
WIRE -384 3824 -592 3824
WIRE -272 3824 -384 3824
WIRE -176 3824 -272 3824
WIRE 1600 3824 1568 3824
WIRE 1808 3824 1680 3824
WIRE 1568 3936 1568 3824
WIRE 1568 3936 96 3936
WIRE 1808 3968 1808 3824
WIRE -384 4000 -384 3824
WIRE -176 4000 -176 3824
WIRE -592 4016 -592 3824
WIRE 96 4016 96 3936
WIRE -592 4176 -592 4080
WIRE -384 4176 -384 4080
WIRE -384 4176 -592 4176
WIRE -176 4176 -176 4080
WIRE -176 4176 -384 4176
WIRE 96 4176 96 4096
WIRE 96 4176 -176 4176
WIRE 1808 4176 1808 4032
WIRE 1808 4176 96 4176
WIRE -592 4208 -592 4176
FLAG 1856 -752 0
FLAG 1280 -752 0
FLAG 1280 -912 VCC_10V
FLAG 1648 -64 GND_B
FLAG 288 -128 M1G
FLAG 560 -128 M2G
FLAG 784 -128 M5G
FLAG 1056 -128 M6G
FLAG 1280 -128 M9G
FLAG 1552 -128 M10G
FLAG 1808 -128 M13G
FLAG 2080 -128 M14G
FLAG 1936 -64 GND_A
FLAG 1440 -752 0
FLAG 1440 -912 CTRL_I
FLAG 1856 -912 CTRL_NI
FLAG 2064 672 M16G
FLAG 1824 672 M15G
FLAG 1536 672 M12G
FLAG 1296 672 M11G
FLAG 1040 672 M8G
FLAG 800 672 M7G
FLAG 544 672 M4G
FLAG 304 672 M3G
FLAG 2160 496 M16S
FLAG 1632 496 M12S
FLAG 1808 512 M15S
FLAG 1280 512 M11S
FLAG 1136 496 M8S
FLAG 784 512 M7S
FLAG 640 496 M4S
FLAG 288 512 M3S
FLAG 2464 160 0
FLAG 2624 160 0
FLAG 2800 160 0
FLAG 2976 160 0
FLAG 2448 624 0
FLAG 2608 624 0
FLAG 2784 624 0
FLAG 2960 624 0
FLAG 2432 1056 0
FLAG 2592 1056 0
FLAG 2768 1056 0
FLAG 2944 1056 0
FLAG 2432 1456 0
FLAG 2592 1456 0
FLAG 2768 1456 0
FLAG 2944 1456 0
FLAG 2464 80 M1G
FLAG 2624 80 M2G
FLAG 2800 80 M5G
FLAG 2976 80 M6G
FLAG 2448 544 M9G
FLAG 2608 544 M10G
FLAG 2784 544 M13G
FLAG 2960 544 M14G
FLAG 2432 976 M3G
FLAG 2592 976 M4G
FLAG 2768 976 M7G
FLAG 2944 976 M8G
FLAG 2432 1376 M11G
FLAG 2592 1376 M12G
FLAG 2768 1376 M15G
FLAG 2944 1376 M16G
FLAG -272 2080 vsoc
FLAG 1808 2080 batt+
FLAG 1808 2432 batt-
FLAG -272 2704 vsoc1
FLAG 1808 2704 batt1+
FLAG 1808 3056 batt1-
FLAG -272 3264 vsoc2
FLAG 1808 3264 batt2+
FLAG 1808 3616 batt2-
FLAG -272 3824 vsoc3
FLAG 1808 3824 batt3+
FLAG 1808 4176 batt3-
FLAG 1584 1376 0
FLAG 1520 1376 batt-
FLAG 1456 1472 batt+
FLAG 1344 1376 batt1-
FLAG 1280 1472 batt1+
FLAG 1104 1472 batt2+
FLAG 1184 1376 batt2-
FLAG 928 1472 batt3+
FLAG 1008 1376 batt3-
SYMBOL nmos 368 176 R90
SYMATTR InstName M1
SYMATTR Value PSMN040100MSE
SYMBOL nmos 640 176 R90
SYMATTR InstName M2
SYMATTR Value PSMN040100MSE
SYMBOL polcap 448 496 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C1
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL polcap 448 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C2
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL nmos 384 736 R90
SYMATTR InstName M3
SYMATTR Value PSMN040100MSE
SYMBOL nmos 624 736 R90
SYMATTR InstName M4
SYMATTR Value PSMN040100MSE
SYMBOL polcap 448 912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C3
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL nmos 864 176 R90
SYMATTR InstName M5
SYMATTR Value PSMN040100MSE
SYMBOL nmos 1136 176 R90
SYMATTR InstName M6
SYMATTR Value PSMN040100MSE
SYMBOL polcap 944 496 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C4
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL polcap 944 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL nmos 880 736 R90
SYMATTR InstName M7
SYMATTR Value PSMN040100MSE
SYMBOL nmos 1120 736 R90
SYMATTR InstName M8
SYMATTR Value PSMN040100MSE
SYMBOL polcap 944 912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C6
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL nmos 1360 176 R90
SYMATTR InstName M9
SYMATTR Value PSMN040100MSE
SYMBOL nmos 1632 176 R90
SYMATTR InstName M10
SYMATTR Value PSMN040100MSE
SYMBOL polcap 1440 496 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C7
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL polcap 1440 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C8
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL nmos 1376 736 R90
SYMATTR InstName M11
SYMATTR Value PSMN040100MSE
SYMBOL nmos 1616 736 R90
SYMATTR InstName M12
SYMATTR Value PSMN040100MSE
SYMBOL polcap 1440 912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C9
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL nmos 1888 176 R90
SYMATTR InstName M13
SYMATTR Value PSMN040100MSE
SYMBOL nmos 2160 176 R90
SYMATTR InstName M14
SYMATTR Value PSMN040100MSE
SYMBOL polcap 1968 496 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C10
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL polcap 1968 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C11
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL nmos 1904 736 R90
SYMATTR InstName M15
SYMATTR Value PSMN040100MSE
SYMBOL nmos 2144 736 R90
SYMATTR InstName M16
SYMATTR Value PSMN040100MSE
SYMBOL polcap 1968 912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C12
SYMATTR Value 2.2m
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine Rser=43m Lser=0 mfg="Nichicon" pn="UPL0J222MPH" type="Al electrolytic"
SYMBOL Cap 512 1024 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value 0.1µ
SYMBOL Cap 1008 1024 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C14
SYMATTR Value 0.1µ
SYMBOL Cap 1504 1024 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C15
SYMATTR Value 0.1µ
SYMBOL Cap 2032 1024 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C16
SYMATTR Value 0.1µ
SYMBOL Voltage 1440 -864 R0
SYMATTR InstName V1
SYMATTR Value PULSE(0 5 0 20n 20n 0.5m 1m)
SYMBOL Voltage 1856 -864 R0
SYMATTR InstName V2
SYMATTR Value PULSE(5 0 0 20n 20n 0.5m 1m)
SYMBOL Voltage 1280 -864 R0
SYMATTR InstName V7
SYMATTR Value 10
SYMBOL Voltage 2464 64 R0
SYMATTR InstName V3
SYMATTR Value PULSE(-13.4 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2624 64 R0
SYMATTR InstName V4
SYMATTR Value PULSE(-10.6 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2800 64 R0
SYMATTR InstName V5
SYMATTR Value PULSE(-13.4 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2448 528 R0
SYMATTR InstName V6
SYMATTR Value PULSE(-13.4 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2784 528 R0
SYMATTR InstName V8
SYMATTR Value PULSE(-13.4 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2976 64 R0
SYMATTR InstName V9
SYMATTR Value PULSE(-10.6 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2608 528 R0
SYMATTR InstName V10
SYMATTR Value PULSE(-10.6 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2960 528 R0
SYMATTR InstName V11
SYMATTR Value PULSE(-10.6 10 0 0 0 0.5m 1m)
SYMBOL Voltage 2432 960 R0
SYMATTR InstName V12
SYMATTR Value PULSE(10 -13.4 0 0 0 0.5m 1m)
SYMBOL Voltage 2592 960 R0
SYMATTR InstName V13
SYMATTR Value PULSE(10 -10.6 0 0 0 0.5m 1m)
SYMBOL Voltage 2768 960 R0
SYMATTR InstName V14
SYMATTR Value PULSE(12 -13.4 0 0 0 0.5m 1m)
SYMBOL Voltage 2944 960 R0
SYMATTR InstName V15
SYMATTR Value PULSE(12 -10 0 0 0 0.5m 1m)
SYMBOL Voltage 2432 1360 R0
SYMATTR InstName V16
SYMATTR Value PULSE(15.54 -13.6 0 0 0 0.5m 1m)
SYMBOL Voltage 2592 1360 R0
SYMATTR InstName V17
SYMATTR Value PULSE(15.54 -10 0 0 0 0.5m 1m)
SYMBOL Voltage 2768 1360 R0
SYMATTR InstName V18
SYMATTR Value PULSE(19 -13.76 0 0 0 0.5m 1m)
SYMBOL Voltage 2944 1360 R0
SYMATTR InstName V19
SYMATTR Value PULSE(19 -10 0 0 0 0.5m 1m)
SYMBOL res -400 2240 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL cap -608 2272 R0
SYMATTR InstName C17
SYMATTR Value 10080
SYMBOL bi -176 2256 R0
SYMATTR InstName B1
SYMATTR Value I=I(R2)
SYMBOL res 1712 2064 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1m
SYMBOL bv 96 2256 R0
WINDOW 3 58 70 Left 2
SYMATTR Value V=4.3*(-8.0128*pwr(V(vsoc),5) + 22.509*pwr(V(vsoc),4) - 19.929*pwr(V(vsoc),3) + 4.332*pwr(V(vsoc),2) + 2.0965*V(vsoc) + 0.0026)+0.1
SYMATTR InstName B2
SYMBOL res -400 2864 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL cap -608 2896 R0
SYMATTR InstName C18
SYMATTR Value 10080
SYMBOL bi -176 2880 R0
SYMATTR InstName B3
SYMATTR Value I=I(R4)
SYMBOL res 1696 2688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1m
SYMBOL bv 96 2880 R0
WINDOW 3 58 70 Left 2
SYMATTR Value V=4.3*(-8.0128*pwr(V(vsoc1),5) + 22.509*pwr(V(vsoc1),4) - 19.929*pwr(V(vsoc1),3) + 4.332*pwr(V(vsoc1),2) + 2.0965*V(vsoc1) + 0.0026)+0.1
SYMATTR InstName B4
SYMBOL res -400 3424 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL cap -608 3456 R0
SYMATTR InstName C19
SYMATTR Value 10080
SYMBOL bi -176 3440 R0
SYMATTR InstName B5
SYMATTR Value I=I(R6)
SYMBOL res 1696 3248 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1m
SYMBOL bv 96 3440 R0
WINDOW 3 58 70 Left 2
SYMATTR Value V=4.3*(-8.0128*pwr(V(vsoc2),5) + 22.509*pwr(V(vsoc2),4) - 19.929*pwr(V(vsoc2),3) + 4.332*pwr(V(vsoc2),2) + 2.0965*V(vsoc2) + 0.0026)+0.1
SYMATTR InstName B6
SYMBOL res -400 3984 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL cap -608 4016 R0
SYMATTR InstName C20
SYMATTR Value 10080
SYMBOL bi -176 4000 R0
SYMATTR InstName B7
SYMATTR Value I=I(R8)
SYMBOL res 1696 3808 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1m
SYMBOL bv 96 4000 R0
WINDOW 3 58 70 Left 2
SYMATTR Value V=4.3*(-8.0128*pwr(V(vsoc3),5) + 22.509*pwr(V(vsoc3),4) - 19.929*pwr(V(vsoc3),3) + 4.332*pwr(V(vsoc3),2) + 2.0965*V(vsoc3) + 0.0026)+0.1
SYMATTR InstName B8
TEXT 1528 -664 Left 2 !.tran 5\n.param capacity = 500
TEXT 1296 -1248 Left 2 ;Battery: MOLICEL 18650 P28A\nCapacity: 2800 mAh\nCell voltage 2.5-4.2V (3.6V)\nCharge current: 2.8A standard, 6.0A maximum\nDischarge current: 35A\nInternal Resistance (AC & DC): 20mOhm\nEnergy Density [volumetric = 610 Wh/l] [Gravimetric = 220 Wh/Kg]
TEXT 1336 -528 Left 2 ;Physical Deployment should use either MOSFET for all M50s:\n- Vishay SQJ868EP\n- IRFH8318PbF
TEXT -672 2368 VLeft 2 ;Ccapacity\n2.8Ahr battery
TEXT 1584 2008 Left 2 ;sense resistor
TEXT 120 2384 Left 2 ;Voc
TEXT -296 2040 Left 2 !.ic V(vsoc)=0.6
TEXT -640 1840 Left 2 ;Ccapacity = 3600*Capacity(Ahr)*f1(Cycle)*f2(Temp)\nvsoc initial condition of 1V is 100% SOC, 0V is 0% SOC\ncycle number and temperature not factored in here
TEXT -424 2368 VLeft 2 ;Rselfdischarge
TEXT -672 2992 VLeft 2 ;Ccapacity\n2.8Ahr battery
TEXT 1560 2640 Left 2 ;sense resistor
TEXT 120 3008 Left 2 ;Voc
TEXT -296 2664 Left 2 !.ic V(vsoc1)=0.86
TEXT -424 2992 VLeft 2 ;Rselfdischarge
TEXT -672 3552 VLeft 2 ;Ccapacity\n2.8Ahr battery
TEXT 1560 3200 Left 2 ;sense resistor
TEXT 120 3568 Left 2 ;Voc
TEXT -296 3224 Left 2 !.ic V(vsoc2)=0.55
TEXT -424 3552 VLeft 2 ;Rselfdischarge
TEXT -672 4112 VLeft 2 ;Ccapacity\n2.8Ahr battery
TEXT 1560 3760 Left 2 ;sense resistor
TEXT 120 4128 Left 2 ;Voc
TEXT -296 3784 Left 2 !.ic V(vsoc3)=0.37
TEXT -424 4112 VLeft 2 ;Rselfdischarge
TEXT 464 1896 Left 2 ;https://youtu.be/2HRr48GR0YE?si=ACdH66sBXoT0bdhA
TEXT 432 2616 Left 2 ;Removed transient modelling in battery
